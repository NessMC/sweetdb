!function(t){var e={};function n(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(i,s,function(e){return t[e]}.bind(null,s));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e){t.exports=require("fs")},function(t,e,n){"use strict";n.r(e);var i=n(0),s=function(){function t(t){this.file=t,this.file=t+".sweet"}return t.prototype.read=function(t){i.readFile(this.file,"UTF-8",(function(e,n){t(e,n)}))},t}(),r=n(4),o=n(7);new(function(){function t(t){this.file=t,this.code=[],this.tokens={},this.types={}}return t.prototype.readTokens=function(){var t=this;i.exists(o.resolve(o.join("src","libs","tokens")),(function(e){e&&i.readdir(o.resolve(o.join("src","libs","tokens")),(function(e,i){if(e)throw e;for(var s=0,r=i;s<r.length;s++){var o=r[s],a=n(9)("./"+o.replace(".ts","")).default;for(var u in a)t.tokens[u]=a[u]}}))}))},t.prototype.readTypes=function(){var t=this;i.exists(o.resolve(o.join("src","libs","types")),(function(e){e&&i.readdir(o.resolve(o.join("src","libs","types")),(function(e,i){if(e)throw e;for(var s=0,r=i;s<r.length;s++){var o=r[s],a=n(11)("./"+o.replace(".ts","")).default;for(var u in a)t.types[u]=a[u]}}))}))},t.prototype.readAST=function(t){for(var e=0,n=t;e<n.length;e++){var i=n[e];i.value.trim().endsWith(":")&&i.children.length>0?(this.code.push(i.value+" {"),this.readAST(i.children),this.code.push("}")):this.code.push(i.value)}},t.prototype.parse=function(){var t=this;this.readTokens(),this.readTypes(),new s(this.file).read((function(e,n){if(e)throw e;n=n.split(/\r?\n/g).join("\n");var i=r.parse(n);for(var s in t.readAST(i.children),t.code){var o=t.code[s],a=(o.split(" ").filter((function(t){return""!==t})),void 0);if(o.endsWith("{"))for(var u in t.tokens){Array.isArray(t.tokens[u])||(t.tokens[u]=[t.tokens[u]]);for(var h=0,l=t.tokens[u];h<l.length;h++){var c=l[h];o.match(new RegExp(c))&&(a=o.split(c).join("").trim().match(/.*?(?=:)/)[0],o='"'+a+'": {')}}if(o.match(/#.*/)&&(o=o.replace("#","//")),o.trim().startsWith("-")){if((o=o.slice(1,o.length).trim().split(/\/\/.*/).join("").trim()).includes("=>")){var f=o.split("=>"),d=(f[0].trim(),f[1].trim());for(var p in t.types)p.toLowerCase()===d.toLowerCase()&&(o=o.replace(d,t.types[p]));o=o.replace("=>",":")}else o+=": /.*/";o+=","}"}"===o.trim()&&(o+=","),o=o.split(" ").filter((function(t){return""!==t})).join(" ")}}))},t}())("tests/db").parse()},function(t,e){t.exports=require("assert")},function(t,e){t.exports={INDENT:t=>({type:"INDENT",value:t}),DEDENT:t=>({type:"DEDENT",value:t}),EXPR:t=>({type:"EXPR",value:t})}},function(t,e,n){var i=n(5);t.exports={parse:function(t,e){return new i(e).parse(t)}}},function(t,e,n){var i=n(2),s=n(6);n(3);class r{constructor(t){this.value=t}set indent(t){this._indent=t,this.children=[]}get indent(){return this._indent}add(t,e){this.children.push(e(t))}getLines(){const t=function(){let t="";for(let e=0;e<this._indent;e++)t+=" ";return t}.bind(this)();let e=[this.value];if(!this.children)return e;for(let n of this.children)e=e.concat(n.getLines().map(e=>t+e));return e}toSource(){return this.getLines().join("\n")}}class o extends r{constructor(){super(null),this.children=[]}getLines(){let t=[];for(let e of this.children)t=t.concat(e.getLines());return t}toSource(){return this.getLines().join("\n")}toString(){return JSON.stringify(children)}}class a{constructor(t){this.replaceNode=t.replaceNode||function(t){return t},this.root=new o,this.lastNode=this.root,this.nodeStack=[this.root]}getTree(){return this.root}parse(t){for(let e of t)"EXPR"==e.type?(this.lastNode=new r(e.value),this.nodeStack[0].add(this.lastNode,this.replaceNode)):"INDENT"==e.type?(this.lastNode.indent=e.value,this.nodeStack.unshift(this.lastNode)):"DEDENT"==e.type&&(i(this.nodeStack[0].indent===e.value),this.nodeStack.shift())}finish(){}}t.exports=class{constructor(t){this.options=t||{},this.lexer=new s(t)}parse(t){let e=this.lexer.lex(t),n=new a(this.options);return n.parse(e),n.finish(),n.getTree()}}},function(t,e,n){var i=n(2),s=n(3);class r{constructor(t){this.str=t;let e=/(^\t+$|^ +$)/m.exec(t);i(null!==e,"Invalid indentation unit: Must be tabs xor spaces"),this.basechar=e[1][0],this.notbasechar=" "===e[1][0]?"\t":" "}toString(){return String(this.str)}}class o{constructor(t){this._array=t,this._sum=0;for(let t=0;t<this._array.length;t++)this._sum+=this._array[t]}push(t){this._array.push(t),this._sum+=t}pop(){let t=this._array.pop();return this._sum-=t,t}sum(){return this._sum}}class a{constructor(t){this.buf="",this.indent_buf="",this.indent=new o([0]),this.tabs=0,this.linebreaks=0,this.options=t}static isFormattingLine(t){return 0===t.length||" "===t[0]||"\t"==t[0]}lex(t){let e=[];for(let n of t)if("\n"===n)if(a.isFormattingLine(this.buf))this.options.linebreaks&&(this.linebreaks+=1),this.buf="",this.tabs=0;else{if(this.tabs<this.indent.sum()){for(;this.tabs<this.indent.sum();)e.push(s.DEDENT(this.indent.pop()));for(let t=0;t<this.linebreaks;t++)e.push(s.EXPR(""))}else if(this.tabs>this.indent.sum()){for(let t=0;t<this.linebreaks;t++)e.push(s.EXPR(""));let t=this.tabs-this.indent.sum();this.indent.push(t),e.push(s.INDENT(t))}else for(let t=0;t<this.linebreaks;t++)e.push(s.EXPR(""));i(this.tabs===this.indent.sum(),"Lexer: Indentation Error: Inconsistent indentation levels"),e.push(s.EXPR(this.buf)),this.linebreaks=0,this.tabs=0,this.buf=""}else if(""===this.buf&&n===this.options.indent.basechar)this.indent_buf+=n,this.indent_buf===this.options.indent.str&&(this.tabs+=1,this.indent_buf="");else{if(""===this.buf&&n===this.options.indent.notbasechar)throw new Error("Lexer: Cannot mix tabs and spaces");this.buf+=n}return e}finish(){this.options.linebreaks=!1;let t=this.lex("\n");for(;this.indent.sum()>0;)t.push(s.DEDENT(this.indent.pop()));return this.finished=!0,t}debug(){console.log(""),console.log("buf: "+JSON.stringify(this.buf)),console.log("indent: "+JSON.stringify(this.indent)),console.log("tabs: "+this.tabs),console.log("linebreaks: "+this.linebreaks),console.log("")}}t.exports=class{constructor(t){this.options=t||{},this.options.linebreaks=this.options.linebreaks||!1,this.options.indent=this.options.indent||" ",this.options.indent=new r(this.options.indent)}lex(t){let e=Object.assign({},this.options),n=new a(e);return n.lex(t).concat(n.finish())}}},function(t,e){t.exports=require("path")},function(t,e,n){"use strict";n.r(e),e.default={SCHEME:["scheme","schema"],GROUP:"group"}},function(t,e,n){var i={"./core":8,"./core.js":8};function s(t){var e=r(t);return n(e)}function r(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}s.keys=function(){return Object.keys(i)},s.resolve=r,t.exports=s,s.id=9},function(t,e,n){"use strict";n.r(e),e.default={STRING:/"(.*?)"/}},function(t,e,n){var i={"./core":10,"./core.js":10};function s(t){var e=r(t);return n(e)}function r(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}s.keys=function(){return Object.keys(i)},s.resolve=r,t.exports=s,s.id=11}]);