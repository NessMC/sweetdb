!function(t){var e={};function s(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=1)}([function(t,e){t.exports=require("fs")},function(t,e,s){"use strict";s.r(e);var i=s(0),n=function(){function t(t){this.file=t,this.file=t+".sweet"}return t.prototype.read=function(t){i.readFile(this.file,"UTF-8",(function(e,s){t(e,s)}))},t}(),r=s(4);new(function(){function t(t){this.file=t,this.code=[],this.types={},this.output=[]}return t.prototype.readAST=function(t){for(var e=0,s=t;e<s.length;e++){var i=s[e];i.value.trim().endsWith(":")&&i.children.length>0?(this.code.push(i.value+" {"),this.readAST(i.children),this.code.push("}")):this.code.push(i.value)}},t.prototype.parse=function(){var t=this;new n(this.file).read((function(e,s){if(e)throw e;s=s.split(/\r?\n/g).filter((function(t){return""!==t})).join("\n");var i=r.parse(s);for(var n in t.readAST(i.children),t.output.push("module.exports = {"),t.code){var o=t.code[n].trim();if(o.endsWith("{"))for(var h=0,u=["scheme","schema","type","group"];h<u.length;h++){var a=u[h];if(o.startsWith(a)){var l=o.substr(a.length,o.length).trim().match(/.*?(?=:)/)[0];o='"'+l.toLowerCase()+'": {',a}}if(o.startsWith("-")){var c=o.slice(1,o.length).trim();if(c.includes("=>")){var p=c.split("=>"),f=p[0].trim(),d=Number(p[1].trim())?parseInt(p[1].trim()):p[1].trim();switch(o=o.replace("=>",":").replace(f,'"'+f+'"').slice(1),f){case"regex":o=o.replace(d,"/"+d+"/")}}else f=c.trim();"}"!==t.code[parseInt(n)+1].trim()&&(o+=",")}o.startsWith("}")&&t.code[parseInt(n)+1]&&"}"!==t.code[parseInt(n)+1].trim()&&(o+=","),t.output.push(o)}t.output.push("}"),console.log(t.output.join("\n"))}))},t}())("tests/type").parse()},function(t,e){t.exports=require("assert")},function(t,e){t.exports={INDENT:t=>({type:"INDENT",value:t}),DEDENT:t=>({type:"DEDENT",value:t}),EXPR:t=>({type:"EXPR",value:t})}},function(t,e,s){var i=s(5);t.exports={parse:function(t,e){return new i(e).parse(t)}}},function(t,e,s){var i=s(2),n=s(6);s(3);class r{constructor(t){this.value=t}set indent(t){this._indent=t,this.children=[]}get indent(){return this._indent}add(t,e){this.children.push(e(t))}getLines(){const t=function(){let t="";for(let e=0;e<this._indent;e++)t+=" ";return t}.bind(this)();let e=[this.value];if(!this.children)return e;for(let s of this.children)e=e.concat(s.getLines().map(e=>t+e));return e}toSource(){return this.getLines().join("\n")}}class o extends r{constructor(){super(null),this.children=[]}getLines(){let t=[];for(let e of this.children)t=t.concat(e.getLines());return t}toSource(){return this.getLines().join("\n")}toString(){return JSON.stringify(children)}}class h{constructor(t){this.replaceNode=t.replaceNode||function(t){return t},this.root=new o,this.lastNode=this.root,this.nodeStack=[this.root]}getTree(){return this.root}parse(t){for(let e of t)"EXPR"==e.type?(this.lastNode=new r(e.value),this.nodeStack[0].add(this.lastNode,this.replaceNode)):"INDENT"==e.type?(this.lastNode.indent=e.value,this.nodeStack.unshift(this.lastNode)):"DEDENT"==e.type&&(i(this.nodeStack[0].indent===e.value),this.nodeStack.shift())}finish(){}}t.exports=class{constructor(t){this.options=t||{},this.lexer=new n(t)}parse(t){let e=this.lexer.lex(t),s=new h(this.options);return s.parse(e),s.finish(),s.getTree()}}},function(t,e,s){var i=s(2),n=s(3);class r{constructor(t){this.str=t;let e=/(^\t+$|^ +$)/m.exec(t);i(null!==e,"Invalid indentation unit: Must be tabs xor spaces"),this.basechar=e[1][0],this.notbasechar=" "===e[1][0]?"\t":" "}toString(){return String(this.str)}}class o{constructor(t){this._array=t,this._sum=0;for(let t=0;t<this._array.length;t++)this._sum+=this._array[t]}push(t){this._array.push(t),this._sum+=t}pop(){let t=this._array.pop();return this._sum-=t,t}sum(){return this._sum}}class h{constructor(t){this.buf="",this.indent_buf="",this.indent=new o([0]),this.tabs=0,this.linebreaks=0,this.options=t}static isFormattingLine(t){return 0===t.length||" "===t[0]||"\t"==t[0]}lex(t){let e=[];for(let s of t)if("\n"===s)if(h.isFormattingLine(this.buf))this.options.linebreaks&&(this.linebreaks+=1),this.buf="",this.tabs=0;else{if(this.tabs<this.indent.sum()){for(;this.tabs<this.indent.sum();)e.push(n.DEDENT(this.indent.pop()));for(let t=0;t<this.linebreaks;t++)e.push(n.EXPR(""))}else if(this.tabs>this.indent.sum()){for(let t=0;t<this.linebreaks;t++)e.push(n.EXPR(""));let t=this.tabs-this.indent.sum();this.indent.push(t),e.push(n.INDENT(t))}else for(let t=0;t<this.linebreaks;t++)e.push(n.EXPR(""));i(this.tabs===this.indent.sum(),"Lexer: Indentation Error: Inconsistent indentation levels"),e.push(n.EXPR(this.buf)),this.linebreaks=0,this.tabs=0,this.buf=""}else if(""===this.buf&&s===this.options.indent.basechar)this.indent_buf+=s,this.indent_buf===this.options.indent.str&&(this.tabs+=1,this.indent_buf="");else{if(""===this.buf&&s===this.options.indent.notbasechar)throw new Error("Lexer: Cannot mix tabs and spaces");this.buf+=s}return e}finish(){this.options.linebreaks=!1;let t=this.lex("\n");for(;this.indent.sum()>0;)t.push(n.DEDENT(this.indent.pop()));return this.finished=!0,t}debug(){console.log(""),console.log("buf: "+JSON.stringify(this.buf)),console.log("indent: "+JSON.stringify(this.indent)),console.log("tabs: "+this.tabs),console.log("linebreaks: "+this.linebreaks),console.log("")}}t.exports=class{constructor(t){this.options=t||{},this.options.linebreaks=this.options.linebreaks||!1,this.options.indent=this.options.indent||" ",this.options.indent=new r(this.options.indent)}lex(t){let e=Object.assign({},this.options),s=new h(e);return s.lex(t).concat(s.finish())}}}]);